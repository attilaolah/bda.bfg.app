Referencebrowser
================

The referencebrowser consists out of some tiles for rendering a
referencebrowser inside an overlay and a yafowil widget for rendering
form fields bound to referencebrowser.

Load requirements.
::

    >>> import yafowil.loader
    >>> import bda.bfg.app.browser.referencebrowser
    >>> from repoze.bfg.testing import DummyRequest

Test widget.
::

    >>> from yafowil.base import factory

Render single valued.
::

    >>> widget = factory(
    ...     'reference',
    ...     'ref',
    ...     props = {
    ...         'label': 'Reference',
    ...         'multivalued': False,
    ...     })
    >>> widget()
    u'<input class="referencebrowser" id="input-ref" name="ref" 
    type="text" value="" /><input name="ref.uid" type="hidden" value="" />'
    
    >>> widget = factory(
    ...     'reference',
    ...     'ref',
    ...     props = {
    ...         'label': 'Reference',
    ...         'multivalued': False,
    ...         'required': 'Ref Required',
    ...     })
    
    >>> request = DummyRequest()
    >>> request.params['ref'] = ''
    >>> request.params['ref.uid'] = ''
    
    >>> data = widget.extract(request)
    >>> data.extracted
    ''
    
    >>> data.errors
    [ExtractionError('Ref Required',)]
    
    >>> request.params['ref'] = 'Title'
    >>> request.params['ref.uid'] = '123'
    >>> data = widget.extract(request)
    >>> data.extracted
    '123'
    
    >>> data.errors
    []
    
    >>> widget = factory(
    ...     'reference',
    ...     'ref',
    ...     value = ['uid', 'Label'],
    ...     props = {
    ...         'label': 'Reference',
    ...         'multivalued': False,
    ...         'required': 'Ref Required',
    ...     })
    >>> widget()
    u'<input class="referencebrowser required" id="input-ref" name="ref" 
    type="text" value="Label" /><input name="ref.uid" type="hidden" 
    value="uid" />'
    
    >>> data = widget.extract(request)
    >>> widget(data=data)
    u'<input class="referencebrowser required" id="input-ref" name="ref" 
    type="text" value="Title" /><input name="ref.uid" type="hidden" 
    value="123" />'
    
    >>> widget(request=request)
    u'<input class="referencebrowser required" id="input-ref" name="ref" 
    type="text" value="Title" /><input name="ref.uid" type="hidden" 
    value="123" />'