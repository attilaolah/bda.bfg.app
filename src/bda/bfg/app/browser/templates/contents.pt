<tal:ajax xmlns:ajax="http://namesspaces.bluedynamics.eu/ajax" omit-tag="True">
  <div id="contentslisting"
       class="contentsbatchsensitiv
              sortingheadsensitiv"
       ajax:bind="batchclicked sortclicked"
       ajax:target="${context.nodeurl}"
       ajax:action="contents:#contentslisting:replace">
  
    <tal:batch replace="structure context.batch" />
  
    <table class="contents">
      <tr class="head"
          tal:define="b_page request.params.get('b_page', '0');
                      cur_sort request.params.get('sort');
                      cur_order request.params.get('order', 'desc');
                      base_url '%s?b_page=%s' % (context.nodeurl, b_page);">
        <th>
          Actions
        </th>
        <th tal:define="selected cur_sort == 'title';
                        alter selected and cur_order == 'desc';
                        order alter and 'asc' or 'desc';
                        sorturl '%s&amp;sort=%s&amp;order=%s' % (base_url, 'title', order);
                        sorted = selected and order or '';"
            tal:attributes="class sorted and sorted or None">
          <a href="${sorturl}"
             title="Sort on title"
             ajax:bind="click"
             ajax:target="${sorturl}"
             ajax:event="sortclicked:.sortingheadsensitiv">
              Title
          </a>
        </th>
        <th tal:define="selected cur_sort == 'creator';
                        alter selected and cur_order == 'desc';
                        order alter and 'asc' or 'desc';
                        sorturl '%s&amp;sort=%s&amp;order=%s' % (base_url, 'creator', order);
                        sorted = selected and order or '';"
            tal:attributes="class sorted and sorted or None">
          <a href="${sorturl}"
             title="Sort on cretor"
             ajax:bind="click"
             ajax:target="${sorturl}"
             ajax:event="sortclicked:.sortingheadsensitiv">
              Creator
          </a>
        </th>
        <th tal:define="selected cur_sort == 'created';
                        alter selected and cur_order == 'desc';
                        order alter and 'asc' or 'desc';
                        sorturl '%s&amp;sort=%s&amp;order=%s' % (base_url, 'created', order);
                        sorted = selected and order or '';"
            tal:attributes="class sorted and sorted or None">
          <a href="${sorturl}"
             title="Sort on created"
             ajax:bind="click"
             ajax:target="${sorturl}"
             ajax:event="sortclicked:.sortingheadsensitiv">
              Created
          </a>
        </th>
        <th tal:define="selected cur_sort == 'modified';
                        alter selected and cur_order == 'desc';
                        order alter and 'asc' or 'desc';
                        sorturl '%s&amp;sort=%s&amp;order=%s' % (base_url, 'modified', order);
                        sorted = selected and order or '';"
            tal:attributes="class sorted and sorted or None">
          <a href="${sorturl}"
             title="Sort on modified"
             ajax:bind="click"
             ajax:target="${sorturl}"
             ajax:event="sortclicked:.sortingheadsensitiv">
              Modified
          </a>
        </th>
      </tr>
      <tal:row repeat="item context.contents.items">
        <tr>
          <td>
            <a href="${context.nodeurl}/${item.__name__}"
               class="view16_16"
               title="View"
               ajax:bind="click"
               ajax:target="${context.nodeurl}/${item.__name__}"
               ajax:event="contextchanged:.contextsensitiv"
               ajax:action="content:#content:inner">
                &nbsp;
            </a>
            <a href="${context.nodeurl}/${item.__name__}/edit?from=parent"
               class="edit16_16"
               title="Edit"
               ajax:bind="click"
               ajax:target="${context.nodeurl}/${item.__name__}?from=parent"
               ajax:event="contextchanged:.contextsensitiv"
               ajax:action="edit:#content:inner"
               tal:condition="item.properties.editable">
                &nbsp;
            </a>
          </td>
          <td>
            <a href="${context.nodeurl}/${item.__name__}"
               ajax:bind="click"
               ajax:target="${context.nodeurl}/${item.__name__}"
               ajax:event="contextchanged:.contextsensitiv"
               ajax:action="content:#content:inner"
               tal:content="item.metadata.get('title', item.__name__)">
                Media
            </a>
          </td>
          <td tal:content="item.metadata.get('creator', 'unknown')">Creator</td>
          <td tal:content="context.format_date(item.metadata.get('created'))">Created</td>
          <td tal:content="context.format_date(item.metadata.get('modified'))">Modified</td>
        </tr>
      </tal:row>
    </table>
  
  </div>
</tal:ajax>